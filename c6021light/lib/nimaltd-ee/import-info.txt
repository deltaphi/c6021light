Imported from https://github.com/nimaltd/ee/tree/49159df81431adce3284ddbf791e6308db82aa0c